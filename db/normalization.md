# 資料庫正規化

可參考這篇[PPT](http://cc.cust.edu.tw/~ccchen/doc/db_04.pdf)，若讀起來很吃力就先往下看吧~

- 資料庫正規化(Database Normalization)

這篇主要是面相給初學者，所以覺得很冗長是正常的!我認為這塊用逆向思維來學比較容易記住。

- Normal Form 簡稱 NF

一些課本開頭都說正規化有什麼好處 blablabla，但對於第一次學的人沒什麼感覺(心理 OS: 喔是喔~然後下個月就忘記了)

## 我們換個方式來學習

- 這邊有一個表格共 4 筆資料，請試著幫我將 PHP 學分改成`3學分`

| 學號      | 姓名 | 性別 | 課程名稱 | 學分 | 必選修 | 成績 | 老師姓名 |
| --------- | ---- | ---- | -------- | ---- | ------ | ---- | -------- |
| S3A517001 | Gura | 女   | PHP      | 2    | 必修   | 74   | 阿錢     |
| S3A517001 | Gura | 女   | JS       | 3    | 必修   | 59   | 阿許     |
| S3A517002 | Ina  | 女   | PHP      | 2    | 必修   | 88   | 阿錢     |
| S3A517002 | Ina  | 女   | UI/UX    | 2    | 選修   | 80   | 阿陳     |

> You: 這很簡單啊 改 2 筆就好

- 那如果今天有 300 筆呢?1000 筆呢?改起來要花幾分鐘呢?

- 再換一個問題幫我新增一個課程 `jQuery 2學分 必修`

> You: 好了!

| 學號 | 姓名 | 性別 | 課程名稱 | 學分 | 必選修 | 成績 | 老師姓名 |
| ---- | ---- | ---- | -------- | ---- | ------ | ---- | -------- |
| NULL | NULL | NULL | jQuery   | 2    | 必修   | NULL | NULL     |

~~沒給我學生和其他資料 新增個毛線阿~~ 這看起來很奇怪對吧!因為資料都黏在一起(耦合太強)。

---

## 工程師很懶的

我們想設計好維護的表(Table)透過上面的例子應該會發現一件事--那就是應該分類!

若將表拆成很細，最後透過電腦組合起來就好了，這也是正規化在做的事情。

不要死記，用理解的，痛過才會花時間找方法精進。

---

## 1NF 一階正規化

- 單欄位不能有 2 筆以上的資料，即單一值(Atomic)
- 每筆資料不能重複(完全一樣)
- 資料要有主鍵(PK)

### 解釋 PK FK 相依來相依去?

- PK (Primary Key) 中文:主鍵
  - 就是唯一值例如身分證字號，學號都只會有一個，這樣就不會找錯人
- FK (Foreign Key) 中文:外鍵
  - 可以記成一個代號，例如:我說`五月天成員`=>可以關連到`瑪莎、怪獸、冠佑、阿信、石頭`

| 學號 | 姓名 | 性別 | 課程名稱 |
| ---- | ---- | ---- | -------- | 
| NULL | NULL | NULL | jQuery   |

- 完全相依
- 部分相依
- 遞移相依(間接相依)

很暴力的解說[相依]: 沒有它就廢掉了，因為無法辨別...
怎麼說呢?

EX:
ID | NAME | TEL.
01 | JACK | 0911111111
02 | JACK | 0922222222
請你把 ID 這列遮起來，告訴我 JACK 的電話是幾號
無法辨別 因為有 2 個人 所以需要 PK

FK

## 2NF 二階正規化

- 符合 1NF
- 將部分相依的資料拆分出去

## 解釋 異常狀況(Anomaly)

資料冗於
更新異常
插入異常
刪除異常

## 3NF 三階正規化

- 符合 2NF
- 各欄位與 PK 沒有遞移相依

## 其他正規化 有興趣可以搜尋

- 4NF
- 5NF
- BCNF

## 參考資料

[Is ERD considered a kind of UML diagram?](https://stackoverflow.com/questions/48191228/is-erd-considered-a-kind-of-uml-diagram)
